(this["webpackJsonpnd0191-myreads-starter"]=this["webpackJsonpnd0191-myreads-starter"]||[]).push([[0],{27:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var o=n(0),s=n.n(o),c=n(22),r=n.n(c),a=(n(27),n(4)),i=n.n(a),l=n(7),u=n(5),h=(n(29),n(19)),b="https://reactnd-books-api.udacity.com",j=localStorage.token;j||(j=localStorage.token=Math.random().toString(36).substr(-8));var d={Accept:"application/json",Authorization:j},f=function(e,t){return fetch("".concat(b,"/search"),{method:"POST",headers:Object(h.a)(Object(h.a)({},d),{},{"Content-Type":"application/json"}),body:JSON.stringify({query:e,maxResults:t})}).then((function(e){return e.json()})).then((function(e){return e.books}))},O=n(10),p=n(3),x=function(e){var t=e.currentShelf,n=e.onMove,o=e.book;return Object(p.jsx)("div",{className:"book-shelf-changer",children:Object(p.jsxs)("select",{defaultValue:t||"none",onChange:function(e){return n(o,e.target.value)},children:[Object(p.jsx)("option",{disabled:!0,children:"Move to..."}),Object(p.jsx)("option",{value:"currentlyReading",children:"Currently Reading"}),Object(p.jsx)("option",{value:"wantToRead",children:"Want to Read"}),Object(p.jsx)("option",{value:"read",children:"Read"}),Object(p.jsx)("option",{value:"none",children:"None"})]})})},k=function(e){e.authors;var t=e.title,n=e.image,o=e.shelf,s=e.onMove,c=e.book;return Object(p.jsxs)("div",{className:"book",children:[Object(p.jsxs)("div",{className:"book-top",children:[Object(p.jsx)("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(n,")")}}),Object(p.jsx)(x,{currentShelf:o,onMove:s,book:c})]}),Object(p.jsx)("div",{className:"book-title",children:t}),Object(p.jsx)("div",{className:"book-authors",children:c.authors?c.authors.join("-"):"NA"})]})},v=function(e){var t=e.books,n=e.updateShelf,s=Object(o.useState)(""),c=Object(u.a)(s,2),r=c[0],a=c[1],h=Object(o.useState)([]),b=Object(u.a)(h,2),j=b[0],d=b[1],x=Object(o.useState)(!1),v=Object(u.a)(x,2),m=v[0],g=v[1];return Object(o.useEffect)((function(){""===r?(d([]),g(!1)):function(){var e=Object(l.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(r);case 2:(n=e.sent).error?(d([]),g(!0)):(n.forEach((function(e){e.shelf="none",t.forEach((function(t){t.id===e.id&&(e.shelf=t.shelf)}))})),console.log(n),d(n),g(!1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[r]),Object(p.jsxs)("div",{className:"search-books",children:[Object(p.jsxs)("div",{className:"search-books-bar",children:[Object(p.jsx)(O.b,{to:"/",className:"close-search",children:"Close"}),Object(p.jsx)("div",{className:"search-books-input-wrapper",children:Object(p.jsx)("input",{type:"text",placeholder:"Search by title, author, or ISBN",onChange:function(e){return function(e){a(e.trim())}(e.target.value)}})})]}),Object(p.jsx)("div",{className:"search-books-results",children:Object(p.jsxs)("ol",{className:"books-grid",children:[j.map((function(e){return Object(p.jsx)("li",{children:Object(p.jsx)(k,{authors:e.authors,title:e.title,image:e.imageLinks?e.imageLinks.smallThumbnail:"http://books.google.com/books/content?id=73kNFV4sDx8C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api",id:e.id,shelf:e.shelf,book:e,onMove:n})},e.id)})),m?"No results found":""]})})]})},m=function(e){var t=e.title,n=e.books,o=e.updateShelf;return Object(p.jsxs)("div",{className:"bookshelf",children:[Object(p.jsx)("h2",{className:"bookshelf-title",children:t}),Object(p.jsx)("div",{className:"bookshelf-books",children:Object(p.jsx)("ol",{className:"books-grid",children:n.map((function(e){return Object(p.jsx)("li",{children:Object(p.jsx)(k,{authors:e.authors,title:e.title,image:e.imageLinks.smallThumbnail,shelf:e.shelf,book:e,onMove:o})},e.id)}))})})]})},g=function(e){var t=e.books,n=e.updateShelf,o=t.filter((function(e){return"currentlyReading"===e.shelf})),s=t.filter((function(e){return"wantToRead"===e.shelf})),c=t.filter((function(e){return"read"===e.shelf}));return Object(p.jsxs)("div",{children:[Object(p.jsx)(m,{title:"Currently Reading",books:o,updateShelf:n}),Object(p.jsx)(m,{title:"Want to Read",books:s,updateShelf:n}),Object(p.jsx)(m,{title:"Read",books:c,updateShelf:n})]})},N=function(e){var t=e.books,n=e.updateShelf;return Object(p.jsx)("div",{className:"app",children:Object(p.jsxs)("div",{className:"list-books",children:[Object(p.jsx)("div",{className:"list-books-title",children:Object(p.jsx)("h1",{children:"MyReads"})}),Object(p.jsxs)("div",{className:"list-books-content",children:[Object(p.jsx)("div",{children:Object(p.jsx)(g,{books:t,updateShelf:n})}),Object(p.jsx)("div",{className:"open-search",children:Object(p.jsx)(O.b,{to:"/search",children:"Add a book"})})]})]})})},S=n(2);var y=function(){var e=Object(o.useState)([]),t=Object(u.a)(e,2),n=t[0],s=t[1],c=function(e,t){var o=n.map((function(n){return n.id===e.id?(e.shelf=t,e):n}));s(o),function(e,t){fetch("".concat(b,"/books/").concat(e.id),{method:"PUT",headers:Object(h.a)(Object(h.a)({},d),{},{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then((function(e){return e.json()}))}(e,t)};return Object(o.useEffect)((function(){(function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(b,"/books"),{headers:d}).then((function(e){return e.json()})).then((function(e){return e.books}));case 3:t=e.sent,s(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Erorr: Server dosen't response!");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(p.jsxs)(S.c,{children:[Object(p.jsx)(S.a,{exact:!0,path:"/",element:Object(p.jsx)(N,{books:n,updateShelf:c})}),Object(p.jsx)(S.a,{exact:!0,path:"/search",element:Object(p.jsx)(v,{books:n,updateShelf:c})})]})};r.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(O.a,{children:Object(p.jsx)(y,{})})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.c5cfb73f.chunk.js.map